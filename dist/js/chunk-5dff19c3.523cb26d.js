(window.webpackJsonp = window.webpackJsonp || []).push([['chunk-5dff19c3'], { '0486': function (e, t, a) { 'use strict'; a('cf0b') }, b0c0: function (e, t, a) { var r = a('83ab'); var n = a('9bf2').f; var o = Function.prototype; var s = o.toString; var i = /^\s*function ([^ (]*)/; var l = 'name'; r && !(l in o) && n(o, l, { configurable: !0, get: function () { try { return s.call(this).match(i)[1] } catch (e) { return '' } } }) }, b986: function (e, t, a) { 'use strict'; a.r(t); var r = function () { var e = this; var t = e.$createElement; var a = e._self._c || t; return a('div', [a('el-card', [a('div', { staticClass: 'clearfix', attrs: { slot: 'header' }, slot: 'header' }, [a('my-breadcrumb', [e._v('个人设置')])], 1), a('el-row', [a('el-col', { attrs: { span: 16 } }, [a('el-form', { attrs: { 'label-width': '120px' } }, [a('el-form-item', { attrs: { label: '编号：' } }, [e._v(e._s(e.userInfo.id))]), a('el-form-item', { attrs: { label: '手机：' } }, [e._v(e._s(e.userInfo.mobile))]), a('el-form-item', { attrs: { label: '媒体名称：' } }, [a('el-input', { model: { value: e.userInfo.name, callback: function (t) { e.$set(e.userInfo, 'name', t) }, expression: 'userInfo.name' } })], 1), a('el-form-item', { attrs: { label: '媒体简介：' } }, [a('el-input', { attrs: { type: 'textarea', rows: 3 }, model: { value: e.userInfo.intro, callback: function (t) { e.$set(e.userInfo, 'intro', t) }, expression: 'userInfo.intro' } })], 1), a('el-form-item', { attrs: { label: '联系邮箱：' } }, [a('el-input', { model: { value: e.userInfo.email, callback: function (t) { e.$set(e.userInfo, 'email', t) }, expression: 'userInfo.email' } })], 1), a('el-form-item', [a('el-button', { attrs: { type: 'primary' }, on: { click: e.hUpdate } }, [e._v('保存设置')])], 1)], 1)], 1), a('el-col', { attrs: { span: 8 } }, [a('el-upload', { staticClass: 'avatar-uploader', attrs: { action: '', 'http-request': e.hUpload, 'show-file-list': !1, 'before-upload': e.hBeforeUpload } }, [e.userInfo.photo ? a('img', { staticClass: 'avatar', attrs: { src: e.userInfo.photo } }) : a('i', { staticClass: 'el-icon-plus avatar-uploader-icon' })])], 1)], 1), a('div')], 1)], 1) }; var n = []; var o = (a('b0c0'), a('96cf'), a('1da1')); var s = { name: 'setting', data: function () { return { headers: { Authorization: 'Bearer '.concat(localStorage.getItem('tokenStr')) }, imageUrl: '', userInfo: { id: '', email: '', intro: '', mobile: '', name: '', photo: '' } } }, created: function () { this.loadUserInfo() }, methods: { hUpload: function (e) { var t = this; return Object(o.a)(regeneratorRuntime.mark(function a () { var r, n, o; return regeneratorRuntime.wrap(function (a) { while (1) switch (a.prev = a.next) { case 0:return a.prev = 0, r = e.file, n = new FormData(), n.append('photo', r), a.next = 6, t.$http({ url: '/mp/v1_0/user/photo', method: 'PATCH', data: n }); case 6:o = a.sent, t.$message.success('更新头像成功'), console.log(o), t.userInfo.photo = o.data.data.photo, t.$eventBus.$emit('update-user-info', { photo: o.data.data.photo }), a.next = 16; break; case 13:a.prev = 13, a.t0 = a.catch(0), console.log(a.t0); case 16:case 'end':return a.stop() } }, a, null, [[0, 13]]) }))() }, loadUserInfo: function () { var e = this; return Object(o.a)(regeneratorRuntime.mark(function t () { var a; return regeneratorRuntime.wrap(function (t) { while (1) switch (t.prev = t.next) { case 0:return t.next = 2, e.$http({ url: '/mp/v1_0/user/profile', method: 'GET' }); case 2:a = t.sent, console.log('获取个人信息', a), e.userInfo.id = a.data.data.id, e.userInfo.email = a.data.data.email, e.userInfo.intro = a.data.data.intro, e.userInfo.mobile = a.data.data.mobile, e.userInfo.name = a.data.data.name, e.userInfo.photo = a.data.data.photo; case 10:case 'end':return t.stop() } }, t) }))() }, hUpdate: function () { this.doSave() }, doSave: function () { var e = this; return Object(o.a)(regeneratorRuntime.mark(function t () { var a, r, n, o, s; return regeneratorRuntime.wrap(function (t) { while (1) switch (t.prev = t.next) { case 0:return a = e.userInfo, r = a.name, n = a.intro, o = a.email, t.prev = 1, t.next = 4, e.$http({ url: '/mp/v1_0/user/profile', method: 'PATCH', data: { name: r, intro: n, email: o } }); case 4:s = t.sent, console.log(s), e.$message.success('修改成功'), e.$eventBus.$emit('update-user-info', { name: r }), t.next = 14; break; case 10:t.prev = 10, t.t0 = t.catch(1), console.log(t.t0), e.$message.error('修改失败'); case 14:case 'end':return t.stop() } }, t, null, [[1, 10]]) }))() }, hBeforeUpload: function (e) { var t = e.type === 'image/jpeg'; var a = e.size / 1024 / 1024 < 2; return t || this.$message.error('上传头像图片只能是 JPG 格式!'), a || this.$message.error('上传头像图片大小不能超过 2MB!'), t && a } } }; var i = s; var l = (a('0486'), a('2877')); var u = Object(l.a)(i, r, n, !1, null, '539ad62a', null); t.default = u.exports }, cf0b: function (e, t, a) {} }])
// # sourceMappingURL=chunk-5dff19c3.523cb26d.js.map
